{
  "openapi": "3.1.0",
  "info": {
    "title": "oxmon API",
    "description": "oxmon 服务器监控 REST API",
    "license": {
      "name": ""
    },
    "version": "0.1.1"
  },
  "paths": {
    "/v1/agents": {
      "get": {
        "tags": [
          "Agents"
        ],
        "summary": "分页查询 Agent 列表。\n默认排序：`last_seen` 倒序；默认分页：`limit=20&offset=0`。",
        "operationId": "list_agents",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent 分页列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AgentResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/agents/whitelist": {
      "get": {
        "tags": [
          "Agents"
        ],
        "summary": "分页查询白名单 Agent 列表（包含在线状态）。\n默认排序：`created_at` 倒序；默认分页：`limit=20&offset=0`。",
        "operationId": "list_whitelist_agents",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "白名单 Agent 分页列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AgentWhitelistDetail"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证"
          },
          "500": {
            "description": "服务器错误"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "新增白名单 Agent。\n鉴权：需要 Bearer Token。",
        "operationId": "add_agent",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/AddAgentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "新增白名单 Agent 结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AddAgentResponse"
                }
              }
            }
          },
          "401": {
            "description": "未认证"
          },
          "409": {
            "description": "Agent ID 已存在"
          },
          "500": {
            "description": "服务器错误"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/agents/whitelist/{id}": {
      "put": {
        "tags": [
          "Agents"
        ],
        "summary": "更新白名单 Agent 信息（按 ID）。\n鉴权：需要 Bearer Token。",
        "operationId": "update_agent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "白名单条目 ID（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateAgentRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "更新白名单 Agent 结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AgentWhitelistDetail"
                }
              }
            }
          },
          "401": {
            "description": "未认证"
          },
          "404": {
            "description": "Agent 不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Agents"
        ],
        "summary": "删除白名单 Agent（按 ID）。\n鉴权：需要 Bearer Token。",
        "operationId": "delete_agent",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "白名单条目 ID（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          },
          "401": {
            "description": "未认证"
          },
          "404": {
            "description": "Agent 不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/agents/whitelist/{id}/token": {
      "post": {
        "tags": [
          "Agents"
        ],
        "summary": "重新生成白名单 Agent 的认证 Token（按 ID）。\n鉴权：需要 Bearer Token。",
        "operationId": "regenerate_token",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "白名单条目 ID（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "重新生成 Token 结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RegenerateTokenResponse"
                }
              }
            }
          },
          "401": {
            "description": "未认证"
          },
          "404": {
            "description": "Agent 不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/agents/{id}/latest": {
      "get": {
        "tags": [
          "Agents"
        ],
        "summary": "获取指定 Agent 的最新指标数据。\n鉴权：需要 Bearer Token。",
        "operationId": "agent_latest",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "Agent ID（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent 最新指标数据",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/LatestMetric"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "Agent 不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/alerts/active": {
      "get": {
        "tags": [
          "Alerts"
        ],
        "summary": "查询当前活跃（未解决）告警。",
        "operationId": "active_alerts",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "活跃告警列表"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/alerts/history": {
      "get": {
        "tags": [
          "Alerts"
        ],
        "summary": "分页查询告警事件历史（支持按 agent_id__eq、severity__eq、时间范围过滤）。\n默认排序：`timestamp` 倒序；默认分页：`limit=20&offset=0`。",
        "operationId": "alert_history",
        "parameters": [
          {
            "name": "agent_id__eq",
            "in": "query",
            "description": "Agent ID 精确匹配（agent_id__eq，可选）",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "severity__eq",
            "in": "query",
            "description": "告警级别精确匹配（severity__eq，可选）",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "timestamp__gte",
            "in": "query",
            "description": "时间下界（timestamp >=，默认为当前时间前 1 天）",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "timestamp__lte",
            "in": "query",
            "description": "时间上界（timestamp <=，默认为当前时间）",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "告警事件分页列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AlertEventResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/alerts/history/{id}/acknowledge": {
      "post": {
        "tags": [
          "Alerts"
        ],
        "summary": "确认告警事件。",
        "operationId": "acknowledge_alert",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "告警事件 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "告警已确认"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "告警不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/alerts/history/{id}/resolve": {
      "post": {
        "tags": [
          "Alerts"
        ],
        "summary": "解决告警事件。",
        "operationId": "resolve_alert",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "告警事件 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "告警已解决"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "告警不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/alerts/rules": {
      "get": {
        "tags": [
          "Alerts"
        ],
        "summary": "分页查询告警规则列表。\n默认排序：`id` 升序；默认分页：`limit=20&offset=0`。",
        "operationId": "list_alert_rules",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "告警规则分页列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AlertRuleResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Alerts"
        ],
        "summary": "创建告警规则。",
        "operationId": "create_alert_rule",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateAlertRuleRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "告警规则已创建",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertRuleDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/alerts/rules/config": {
      "get": {
        "tags": [
          "Alerts"
        ],
        "summary": "列出持久化的告警规则。",
        "operationId": "list_alert_rules_config",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "告警规则配置列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/AlertRuleDetailResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/alerts/rules/{id}": {
      "get": {
        "tags": [
          "Alerts"
        ],
        "summary": "获取单条告警规则详情。",
        "operationId": "get_alert_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "告警规则 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "告警规则详情",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertRuleDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "规则不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Alerts"
        ],
        "summary": "更新告警规则。",
        "operationId": "update_alert_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "告警规则 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {}
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "告警规则已更新",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertRuleDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "规则不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Alerts"
        ],
        "summary": "删除告警规则。",
        "operationId": "delete_alert_rule",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "告警规则 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "告警规则已删除"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "规则不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/alerts/rules/{id}/enable": {
      "put": {
        "tags": [
          "Alerts"
        ],
        "summary": "启用或禁用告警规则。",
        "operationId": "set_alert_rule_enabled",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "告警规则 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EnableRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "告警规则状态已更新",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AlertRuleDetailResponse"
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "规则不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/alerts/summary": {
      "get": {
        "tags": [
          "Alerts"
        ],
        "summary": "告警统计摘要。",
        "operationId": "alert_summary",
        "responses": {
          "200": {
            "description": "告警统计摘要"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/auth/login": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "用户登录并获取 JWT。\n鉴权：无需 Bearer Token。",
        "operationId": "login",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "登录结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/LoginResponse"
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "401": {
            "description": "认证失败（用户名或密码错误）",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        }
      }
    },
    "/v1/auth/password": {
      "post": {
        "tags": [
          "Auth"
        ],
        "summary": "修改当前登录用户密码。\n鉴权：需要 Bearer Token。",
        "operationId": "change_password",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangePasswordRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "密码修改成功（需重新登录）"
          },
          "400": {
            "description": "请求参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "401": {
            "description": "认证失败或当前密码错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "500": {
            "description": "服务器内部错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certificates": {
      "get": {
        "tags": [
          "Certificates"
        ],
        "summary": "分页查询证书详情列表（支持过滤）。\n默认排序：`not_after` 升序；默认分页：`limit=20&offset=0`。",
        "operationId": "list_certificates",
        "parameters": [
          {
            "name": "not_after__lte",
            "in": "query",
            "description": "证书过期时间上界（not_after__lte，可选，Unix 秒级时间戳）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64"
            }
          },
          {
            "name": "ip_address__contains",
            "in": "query",
            "description": "IP 包含匹配（ip_address__contains，可选）",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "issuer__contains",
            "in": "query",
            "description": "颁发者包含匹配（issuer__contains，可选）",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "证书详情分页列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CertificateDetails"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证"
          },
          "500": {
            "description": "服务器错误"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certificates/{id}": {
      "get": {
        "tags": [
          "Certificates"
        ],
        "summary": "获取指定证书详情（按 ID）。\n鉴权：需要 Bearer Token。",
        "operationId": "get_certificate",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "证书 ID（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "证书详情",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertificateDetails"
                }
              }
            }
          },
          "401": {
            "description": "未认证"
          },
          "404": {
            "description": "证书不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certificates/{id}/chain": {
      "get": {
        "tags": [
          "Certificates"
        ],
        "summary": "获取指定证书的证书链验证详情（按 ID）。\n鉴权：需要 Bearer Token。",
        "operationId": "get_certificate_chain",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "证书 ID（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "证书链验证详情",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertificateChainInfo"
                }
              }
            }
          },
          "401": {
            "description": "未认证"
          },
          "404": {
            "description": "证书不存在"
          },
          "500": {
            "description": "服务器错误"
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certs/check": {
      "post": {
        "tags": [
          "Certificates"
        ],
        "summary": "手动触发所有已启用域名证书检查。\n鉴权：需要 Bearer Token。",
        "operationId": "check_all_domains",
        "responses": {
          "200": {
            "description": "手动批量证书检查结果",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CertCheckResult"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certs/domains": {
      "get": {
        "tags": [
          "Certificates"
        ],
        "summary": "分页查询监控域名列表（支持按 enabled__eq、domain__contains 过滤）。\n默认排序：`created_at` 倒序；默认分页：`limit=20&offset=0`。",
        "operationId": "list_domains",
        "parameters": [
          {
            "name": "enabled__eq",
            "in": "query",
            "description": "启用状态精确匹配（enabled__eq，可选）",
            "required": false,
            "schema": {
              "type": "boolean"
            }
          },
          {
            "name": "domain__contains",
            "in": "query",
            "description": "域名包含匹配（domain__contains，可选）",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "监控域名分页列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CertDomain"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Certificates"
        ],
        "summary": "新增证书监控域名。\n鉴权：需要 Bearer Token。",
        "operationId": "create_domain",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateDomainRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "新增监控域名结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertDomain"
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "409": {
            "description": "域名已存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certs/domains/batch": {
      "post": {
        "tags": [
          "Certificates"
        ],
        "summary": "批量新增证书监控域名。\n鉴权：需要 Bearer Token。",
        "operationId": "create_domains_batch",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/BatchCreateDomainsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "批量新增监控域名结果",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CertDomain"
                  }
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "409": {
            "description": "域名重复",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certs/domains/{id}": {
      "get": {
        "tags": [
          "Certificates"
        ],
        "summary": "获取监控域名详情（按 ID）。\n鉴权：需要 Bearer Token。",
        "operationId": "get_domain",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "监控域名 ID（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "监控域名详情",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertDomain"
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "域名不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Certificates"
        ],
        "summary": "更新监控域名配置（按 ID）。\n鉴权：需要 Bearer Token。",
        "operationId": "update_domain",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "监控域名 ID（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateDomainRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "更新监控域名结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertDomain"
                }
              }
            }
          },
          "400": {
            "description": "请求参数错误",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "域名不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Certificates"
        ],
        "summary": "删除监控域名（按 ID）。\n鉴权：需要 Bearer Token。",
        "operationId": "delete_domain",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "监控域名 ID（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "删除成功"
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "域名不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certs/domains/{id}/check": {
      "post": {
        "tags": [
          "Certificates"
        ],
        "summary": "手动触发指定域名证书检查（按 ID）。\n鉴权：需要 Bearer Token。",
        "operationId": "check_single_domain",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "监控域名 ID（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "手动证书检查结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertCheckResult"
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "域名不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certs/domains/{id}/history": {
      "get": {
        "tags": [
          "Certificates"
        ],
        "summary": "获取指定域名的证书检查历史记录。",
        "operationId": "cert_check_history",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "域名 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "证书检查历史"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "域名不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certs/status": {
      "get": {
        "tags": [
          "Certificates"
        ],
        "summary": "分页查询所有域名的最新证书检查结果。\n默认排序：`checked_at` 倒序；默认分页：`limit=20&offset=0`。",
        "operationId": "cert_status_all",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "域名证书状态分页列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CertCheckResult"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certs/status/{domain}": {
      "get": {
        "tags": [
          "Certificates"
        ],
        "summary": "获取指定域名的最新证书检查结果。\n鉴权：需要 Bearer Token。",
        "operationId": "cert_status_by_domain",
        "parameters": [
          {
            "name": "domain",
            "in": "path",
            "description": "监控域名（路径参数）",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "域名最新证书检查结果",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CertCheckResult"
                }
              }
            }
          },
          "401": {
            "description": "未授权",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "域名不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/certs/summary": {
      "get": {
        "tags": [
          "Certificates"
        ],
        "summary": "证书健康摘要。",
        "operationId": "cert_summary",
        "responses": {
          "200": {
            "description": "证书健康摘要"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/dashboard/overview": {
      "get": {
        "tags": [
          "Dashboard"
        ],
        "summary": "获取仪表盘概览数据。\n鉴权：需要 Bearer Token。",
        "operationId": "dashboard_overview",
        "responses": {
          "200": {
            "description": "仪表盘概览",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DashboardOverview"
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/health": {
      "get": {
        "tags": [
          "Health"
        ],
        "summary": "获取服务健康状态。\n鉴权：无需 Bearer Token。",
        "operationId": "health",
        "responses": {
          "200": {
            "description": "服务健康状态",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/HealthResponse"
                }
              }
            }
          }
        }
      }
    },
    "/v1/metrics": {
      "get": {
        "tags": [
          "Metrics"
        ],
        "summary": "分页查询指标数据点列表（支持按 agent_id__eq、metric_name__eq、时间范围过滤）。\n默认排序：`created_at` 倒序；默认分页：`limit=20&offset=0`。",
        "operationId": "query_all_metrics",
        "parameters": [
          {
            "name": "agent_id__eq",
            "in": "query",
            "description": "Agent ID 精确匹配（agent_id__eq，可选）",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "metric_name__eq",
            "in": "query",
            "description": "指标名称精确匹配（metric_name__eq，可选）",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "timestamp__gte",
            "in": "query",
            "description": "时间下界（timestamp >=，默认为当前时间前 1 小时）",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "timestamp__lte",
            "in": "query",
            "description": "时间上界（timestamp <=，默认为当前时间）",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "指标数据点分页列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/MetricDataPointResponse"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/metrics/agents": {
      "get": {
        "tags": [
          "Metrics"
        ],
        "summary": "获取时间范围内所有上报 Agent ID。",
        "operationId": "metric_agents",
        "parameters": [
          {
            "name": "timestamp__gte",
            "in": "query",
            "description": "时间下界（默认前 24 小时）",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "timestamp__lte",
            "in": "query",
            "description": "时间上界（默认当前时间）",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Agent ID 列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/metrics/names": {
      "get": {
        "tags": [
          "Metrics"
        ],
        "summary": "获取时间范围内所有指标名称。",
        "operationId": "metric_names",
        "parameters": [
          {
            "name": "timestamp__gte",
            "in": "query",
            "description": "时间下界（默认前 24 小时）",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "timestamp__lte",
            "in": "query",
            "description": "时间上界（默认当前时间）",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "指标名称列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/metrics/summary": {
      "get": {
        "tags": [
          "Metrics"
        ],
        "summary": "获取指标聚合统计（min/max/avg/count）。",
        "operationId": "metric_summary",
        "parameters": [
          {
            "name": "agent_id",
            "in": "query",
            "description": "Agent ID（必填）",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "metric_name",
            "in": "query",
            "description": "指标名称（必填）",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "timestamp__gte",
            "in": "query",
            "description": "时间下界（默认前 1 小时）",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          },
          {
            "name": "timestamp__lte",
            "in": "query",
            "description": "时间上界（默认当前时间）",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "指标聚合统计"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/notifications/channels": {
      "get": {
        "tags": [
          "Notifications"
        ],
        "summary": "列出所有通知渠道配置（含收件人）。",
        "operationId": "list_channels",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "通知渠道列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ChannelOverview"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/notifications/channels/config": {
      "get": {
        "tags": [
          "Notifications"
        ],
        "summary": "列出持久化的通知渠道配置。",
        "operationId": "list_channel_configs",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "通知渠道配置列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {}
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Notifications"
        ],
        "summary": "创建通知渠道配置（含收件人）。",
        "operationId": "create_channel_config",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateChannelRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "通知渠道已创建",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/notifications/channels/config/{id}": {
      "put": {
        "tags": [
          "Notifications"
        ],
        "summary": "更新通知渠道配置。",
        "operationId": "update_channel_config",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "渠道配置 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {}
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "通知渠道已更新",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "渠道不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "delete": {
        "tags": [
          "Notifications"
        ],
        "summary": "删除通知渠道配置。",
        "operationId": "delete_channel_config",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "渠道配置 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "通知渠道已删除"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "渠道不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/notifications/channels/{id}/recipients": {
      "get": {
        "tags": [
          "Notifications"
        ],
        "summary": "获取渠道收件人列表。",
        "operationId": "get_recipients",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "渠道 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "收件人列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "put": {
        "tags": [
          "Notifications"
        ],
        "summary": "设置（替换）渠道收件人列表。",
        "operationId": "set_recipients",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "渠道 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/SetRecipientsRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "收件人已更新",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "string"
                  }
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "渠道不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/notifications/channels/{id}/test": {
      "post": {
        "tags": [
          "Notifications"
        ],
        "summary": "发送测试通知到指定渠道（按 ID）。",
        "operationId": "test_channel",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "渠道 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "测试通知已发送"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "渠道不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/notifications/silence-windows": {
      "get": {
        "tags": [
          "Notifications"
        ],
        "summary": "列出持久化的静默窗口。",
        "operationId": "list_silence_windows",
        "parameters": [
          {
            "name": "limit",
            "in": "query",
            "description": "每页条数（默认 20）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          },
          {
            "name": "offset",
            "in": "query",
            "description": "偏移量（默认 0）",
            "required": false,
            "schema": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            }
          }
        ],
        "responses": {
          "200": {
            "description": "静默窗口列表",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {}
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      },
      "post": {
        "tags": [
          "Notifications"
        ],
        "summary": "创建静默窗口。",
        "operationId": "create_silence_window",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CreateSilenceWindowRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "201": {
            "description": "静默窗口已创建",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/notifications/silence-windows/{id}": {
      "delete": {
        "tags": [
          "Notifications"
        ],
        "summary": "删除静默窗口。",
        "operationId": "delete_silence_window",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "description": "静默窗口 ID",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "静默窗口已删除"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          },
          "404": {
            "description": "静默窗口不存在",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/system/config": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "获取运行时配置（敏感字段已脱敏）。\n鉴权：需要 Bearer Token。",
        "operationId": "get_system_config",
        "responses": {
          "200": {
            "description": "运行时配置",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/RuntimeConfig"
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/system/storage": {
      "get": {
        "tags": [
          "System"
        ],
        "summary": "获取存储分区信息。\n鉴权：需要 Bearer Token。",
        "operationId": "get_storage_info",
        "responses": {
          "200": {
            "description": "存储分区信息",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/StorageInfo"
                }
              }
            }
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    },
    "/v1/system/storage/cleanup": {
      "post": {
        "tags": [
          "System"
        ],
        "summary": "手动触发存储清理。\n鉴权：需要 Bearer Token。",
        "operationId": "trigger_cleanup",
        "responses": {
          "200": {
            "description": "清理结果"
          },
          "401": {
            "description": "未认证",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ApiError"
                }
              }
            }
          }
        },
        "security": [
          {
            "bearer_auth": []
          }
        ]
      }
    }
  },
  "components": {
    "schemas": {
      "AddAgentRequest": {
        "type": "object",
        "description": "添加 Agent 到白名单请求",
        "required": [
          "agent_id"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "description": "Agent ID（必填，需全局唯一）"
          },
          "description": {
            "type": [
              "string",
              "null"
            ],
            "description": "描述信息（可选）"
          }
        }
      },
      "AddAgentResponse": {
        "type": "object",
        "description": "添加 Agent 响应（包含生成的 token）",
        "required": [
          "id",
          "agent_id",
          "token",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "唯一标识"
          },
          "agent_id": {
            "type": "string",
            "description": "Agent 唯一标识"
          },
          "token": {
            "type": "string",
            "description": "生成的认证 token（仅在创建时返回一次）"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间"
          }
        }
      },
      "AgentResponse": {
        "type": "object",
        "description": "Agent 信息",
        "required": [
          "agent_id",
          "status"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "description": "Agent 唯一标识"
          },
          "last_seen": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "description": "最后上报时间"
          },
          "status": {
            "type": "string",
            "description": "状态（active / inactive / unknown）"
          }
        }
      },
      "AgentWhitelistDetail": {
        "type": "object",
        "description": "Agent 白名单详情（包含在线状态）",
        "required": [
          "id",
          "agent_id",
          "created_at",
          "updated_at",
          "status"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "唯一标识"
          },
          "agent_id": {
            "type": "string",
            "description": "Agent 唯一标识"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间"
          },
          "description": {
            "type": [
              "string",
              "null"
            ],
            "description": "描述信息"
          },
          "token": {
            "type": [
              "string",
              "null"
            ],
            "description": "认证 Token（用于 Agent gRPC 配置）"
          },
          "last_seen": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "description": "最后上报时间"
          },
          "status": {
            "type": "string",
            "description": "在线状态（active / inactive / unknown）"
          }
        }
      },
      "AlertEventResponse": {
        "type": "object",
        "description": "告警事件",
        "required": [
          "id",
          "rule_id",
          "agent_id",
          "metric_name",
          "severity",
          "message",
          "value",
          "threshold",
          "timestamp"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "事件唯一标识"
          },
          "rule_id": {
            "type": "string",
            "description": "触发规则 ID"
          },
          "agent_id": {
            "type": "string",
            "description": "Agent 唯一标识"
          },
          "metric_name": {
            "type": "string",
            "description": "指标名称"
          },
          "severity": {
            "type": "string",
            "description": "告警级别"
          },
          "message": {
            "type": "string",
            "description": "告警消息"
          },
          "value": {
            "type": "number",
            "format": "double",
            "description": "当前指标值"
          },
          "threshold": {
            "type": "number",
            "format": "double",
            "description": "告警阈值"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "触发时间"
          },
          "predicted_breach": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "description": "预测突破时间（趋势预测规则）"
          }
        }
      },
      "AlertRuleDetailResponse": {
        "type": "object",
        "description": "告警规则详情",
        "required": [
          "id",
          "name",
          "rule_type",
          "metric",
          "agent_pattern",
          "severity",
          "enabled",
          "config_json",
          "silence_secs",
          "source",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "rule_type": {
            "type": "string"
          },
          "metric": {
            "type": "string"
          },
          "agent_pattern": {
            "type": "string"
          },
          "severity": {
            "type": "string"
          },
          "enabled": {
            "type": "boolean"
          },
          "config_json": {
            "type": "string"
          },
          "silence_secs": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          },
          "source": {
            "type": "string"
          },
          "created_at": {
            "type": "string",
            "format": "date-time"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time"
          }
        }
      },
      "AlertRuleResponse": {
        "type": "object",
        "description": "告警规则信息",
        "required": [
          "id",
          "metric",
          "agent_pattern",
          "severity"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "规则唯一标识"
          },
          "metric": {
            "type": "string",
            "description": "监控指标名称"
          },
          "agent_pattern": {
            "type": "string",
            "description": "Agent 匹配模式（支持 glob）"
          },
          "severity": {
            "type": "string",
            "description": "告警级别"
          }
        }
      },
      "ApiError": {
        "type": "object",
        "description": "API 错误响应",
        "required": [
          "err_code",
          "err_msg",
          "trace_id"
        ],
        "properties": {
          "err_code": {
            "type": "integer",
            "format": "int32",
            "description": "错误码"
          },
          "err_msg": {
            "type": "string",
            "description": "错误信息"
          },
          "trace_id": {
            "type": "string",
            "description": "链路追踪 ID（默认空字符串）"
          }
        }
      },
      "BatchCreateDomainsRequest": {
        "type": "object",
        "description": "批量创建域名请求",
        "required": [
          "domains"
        ],
        "properties": {
          "domains": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/CreateDomainRequest"
            },
            "description": "待新增监控域名列表（必填）"
          }
        }
      },
      "CertCheckResult": {
        "type": "object",
        "description": "证书检查结果",
        "required": [
          "id",
          "domain_id",
          "domain",
          "is_valid",
          "chain_valid",
          "checked_at",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "结果唯一标识"
          },
          "domain_id": {
            "type": "string",
            "description": "关联域名 ID"
          },
          "domain": {
            "type": "string",
            "description": "域名地址"
          },
          "is_valid": {
            "type": "boolean",
            "description": "证书是否有效"
          },
          "chain_valid": {
            "type": "boolean",
            "description": "证书链是否有效"
          },
          "not_before": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "description": "证书生效时间"
          },
          "not_after": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "description": "证书过期时间"
          },
          "days_until_expiry": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "description": "距离过期天数"
          },
          "issuer": {
            "type": [
              "string",
              "null"
            ],
            "description": "证书颁发者"
          },
          "subject": {
            "type": [
              "string",
              "null"
            ],
            "description": "证书主体"
          },
          "san_list": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "type": "string"
            },
            "description": "主体备用名称列表（SAN）"
          },
          "resolved_ips": {
            "type": [
              "array",
              "null"
            ],
            "items": {
              "type": "string"
            },
            "description": "域名解析 IP 地址列表"
          },
          "error": {
            "type": [
              "string",
              "null"
            ],
            "description": "错误信息"
          },
          "checked_at": {
            "type": "string",
            "format": "date-time",
            "description": "检查时间"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间"
          }
        }
      },
      "CertDomain": {
        "type": "object",
        "description": "证书监控域名",
        "required": [
          "id",
          "domain",
          "port",
          "enabled",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "域名唯一标识"
          },
          "domain": {
            "type": "string",
            "description": "监控域名（必填，如 example.com）"
          },
          "port": {
            "type": "integer",
            "format": "int32",
            "description": "端口号"
          },
          "enabled": {
            "type": "boolean",
            "description": "是否启用监控"
          },
          "check_interval_secs": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "description": "检查间隔秒数（可选）",
            "minimum": 0
          },
          "note": {
            "type": [
              "string",
              "null"
            ],
            "description": "备注（可选）"
          },
          "last_checked_at": {
            "type": [
              "string",
              "null"
            ],
            "format": "date-time",
            "description": "最后检查时间"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间"
          }
        }
      },
      "CertSummary": {
        "type": "object",
        "required": [
          "total_domains",
          "valid",
          "invalid",
          "expiring_soon"
        ],
        "properties": {
          "total_domains": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          },
          "valid": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          },
          "invalid": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          },
          "expiring_soon": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          }
        }
      },
      "CertificateChainInfo": {
        "type": "object",
        "description": "证书链信息",
        "required": [
          "id",
          "domain",
          "chain_valid",
          "last_checked"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "证书唯一标识"
          },
          "domain": {
            "type": "string",
            "description": "域名"
          },
          "chain_valid": {
            "type": "boolean",
            "description": "证书链是否有效"
          },
          "chain_error": {
            "type": [
              "string",
              "null"
            ],
            "description": "证书链错误信息"
          },
          "last_checked": {
            "type": "string",
            "format": "date-time",
            "description": "最后检查时间"
          }
        }
      },
      "CertificateDetails": {
        "type": "object",
        "description": "证书详细信息",
        "required": [
          "id",
          "domain",
          "not_before",
          "not_after",
          "ip_addresses",
          "subject_alt_names",
          "chain_valid",
          "last_checked",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "唯一标识"
          },
          "domain": {
            "type": "string",
            "description": "域名"
          },
          "not_before": {
            "type": "string",
            "format": "date-time",
            "description": "证书生效时间"
          },
          "not_after": {
            "type": "string",
            "format": "date-time",
            "description": "证书过期时间"
          },
          "ip_addresses": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "IP 地址列表"
          },
          "issuer_cn": {
            "type": [
              "string",
              "null"
            ],
            "description": "颁发者通用名称"
          },
          "issuer_o": {
            "type": [
              "string",
              "null"
            ],
            "description": "颁发者组织"
          },
          "issuer_ou": {
            "type": [
              "string",
              "null"
            ],
            "description": "颁发者组织单位"
          },
          "issuer_c": {
            "type": [
              "string",
              "null"
            ],
            "description": "颁发者国家"
          },
          "subject_alt_names": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "主体备用名称列表"
          },
          "chain_valid": {
            "type": "boolean",
            "description": "证书链是否有效"
          },
          "chain_error": {
            "type": [
              "string",
              "null"
            ],
            "description": "证书链错误信息"
          },
          "last_checked": {
            "type": "string",
            "format": "date-time",
            "description": "最后检查时间"
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间"
          },
          "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "更新时间"
          }
        }
      },
      "ChangePasswordRequest": {
        "type": "object",
        "description": "修改密码请求",
        "required": [
          "current_password",
          "new_password"
        ],
        "properties": {
          "current_password": {
            "type": "string",
            "description": "当前密码（必填）"
          },
          "new_password": {
            "type": "string",
            "description": "新密码（必填）"
          }
        }
      },
      "ChannelOverview": {
        "type": "object",
        "description": "通知渠道概览（含收件人列表）",
        "required": [
          "id",
          "name",
          "channel_type",
          "min_severity",
          "enabled",
          "recipients",
          "created_at",
          "updated_at"
        ],
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "channel_type": {
            "type": "string"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "min_severity": {
            "type": "string"
          },
          "enabled": {
            "type": "boolean"
          },
          "recipient_type": {
            "type": [
              "string",
              "null"
            ]
          },
          "recipients": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "created_at": {
            "type": "string"
          },
          "updated_at": {
            "type": "string"
          }
        }
      },
      "CreateAlertRuleRequest": {
        "type": "object",
        "required": [
          "name",
          "rule_type",
          "metric"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "rule_type": {
            "type": "string"
          },
          "metric": {
            "type": "string"
          },
          "agent_pattern": {
            "type": "string"
          },
          "severity": {
            "type": "string"
          },
          "config_json": {
            "type": "string"
          },
          "silence_secs": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          }
        }
      },
      "CreateChannelRequest": {
        "type": "object",
        "required": [
          "name",
          "channel_type"
        ],
        "properties": {
          "name": {
            "type": "string"
          },
          "channel_type": {
            "type": "string"
          },
          "description": {
            "type": [
              "string",
              "null"
            ]
          },
          "min_severity": {
            "type": "string"
          },
          "config_json": {
            "type": "string"
          },
          "recipients": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "CreateDomainRequest": {
        "type": "object",
        "description": "创建域名请求",
        "required": [
          "domain"
        ],
        "properties": {
          "domain": {
            "type": "string",
            "description": "监控域名（必填，如 example.com）"
          },
          "port": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int32",
            "description": "监控端口（可选，默认 443）"
          },
          "check_interval_secs": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "description": "检查间隔秒数（可选）",
            "minimum": 0
          },
          "note": {
            "type": [
              "string",
              "null"
            ],
            "description": "备注（可选）"
          }
        }
      },
      "CreateSilenceWindowRequest": {
        "type": "object",
        "required": [
          "start_time",
          "end_time"
        ],
        "properties": {
          "start_time": {
            "type": "string"
          },
          "end_time": {
            "type": "string"
          },
          "recurrence": {
            "type": [
              "string",
              "null"
            ]
          }
        }
      },
      "DashboardOverview": {
        "type": "object",
        "description": "仪表盘概览数据",
        "required": [
          "active_agents",
          "total_agents",
          "alerts_24h",
          "alerts_by_severity",
          "cert_summary",
          "partition_count",
          "storage_total_bytes",
          "uptime_secs"
        ],
        "properties": {
          "active_agents": {
            "type": "integer",
            "description": "活跃 Agent 数量",
            "minimum": 0
          },
          "total_agents": {
            "type": "integer",
            "description": "已注册 Agent 总数",
            "minimum": 0
          },
          "alerts_24h": {
            "type": "integer",
            "format": "int64",
            "description": "24 小时内告警总数",
            "minimum": 0
          },
          "alerts_by_severity": {
            "type": "object",
            "description": "告警按级别统计",
            "additionalProperties": {
              "type": "integer",
              "format": "int64",
              "minimum": 0
            },
            "propertyNames": {
              "type": "string"
            }
          },
          "cert_summary": {
            "$ref": "#/components/schemas/CertSummary",
            "description": "证书健康摘要"
          },
          "partition_count": {
            "type": "integer",
            "description": "存储分区数量",
            "minimum": 0
          },
          "storage_total_bytes": {
            "type": "integer",
            "format": "int64",
            "description": "存储总大小（字节）",
            "minimum": 0
          },
          "uptime_secs": {
            "type": "integer",
            "format": "int64",
            "description": "服务运行时长（秒）"
          }
        }
      },
      "EnableRequest": {
        "type": "object",
        "required": [
          "enabled"
        ],
        "properties": {
          "enabled": {
            "type": "boolean"
          }
        }
      },
      "HealthResponse": {
        "type": "object",
        "description": "健康检查响应",
        "required": [
          "version",
          "uptime_secs",
          "agent_count",
          "storage_status"
        ],
        "properties": {
          "version": {
            "type": "string",
            "description": "服务版本号"
          },
          "uptime_secs": {
            "type": "integer",
            "format": "int64",
            "description": "运行时长（秒）"
          },
          "agent_count": {
            "type": "integer",
            "description": "已注册 Agent 数量",
            "minimum": 0
          },
          "storage_status": {
            "type": "string",
            "description": "存储状态"
          }
        }
      },
      "LatestMetric": {
        "type": "object",
        "description": "最新指标数据",
        "required": [
          "metric_name",
          "value",
          "labels",
          "timestamp"
        ],
        "properties": {
          "metric_name": {
            "type": "string",
            "description": "指标名称"
          },
          "value": {
            "type": "number",
            "format": "double",
            "description": "指标值"
          },
          "labels": {
            "type": "object",
            "description": "标签 (如 mount=/、interface=eth0、core=0)",
            "additionalProperties": {
              "type": "string"
            },
            "propertyNames": {
              "type": "string"
            }
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "采集时间"
          }
        }
      },
      "LoginRequest": {
        "type": "object",
        "description": "登录请求",
        "required": [
          "username",
          "password"
        ],
        "properties": {
          "username": {
            "type": "string",
            "description": "登录用户名（必填）"
          },
          "password": {
            "type": "string",
            "description": "登录密码（必填）"
          }
        }
      },
      "LoginResponse": {
        "type": "object",
        "description": "登录响应",
        "required": [
          "token",
          "expires_in"
        ],
        "properties": {
          "token": {
            "type": "string",
            "description": "JWT Token"
          },
          "expires_in": {
            "type": "integer",
            "format": "int64",
            "description": "Token 有效期（秒）",
            "minimum": 0
          }
        }
      },
      "MetricDataPointResponse": {
        "type": "object",
        "description": "指标数据点（完整）",
        "required": [
          "id",
          "timestamp",
          "agent_id",
          "metric_name",
          "value",
          "labels",
          "created_at"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "指标唯一标识"
          },
          "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "采集时间"
          },
          "agent_id": {
            "type": "string",
            "description": "Agent 唯一标识"
          },
          "metric_name": {
            "type": "string",
            "description": "指标名称"
          },
          "value": {
            "type": "number",
            "format": "double",
            "description": "指标值"
          },
          "labels": {
            "type": "object",
            "description": "指标标签（如 mount=/、interface=eth0、core=0）",
            "additionalProperties": {
              "type": "string"
            },
            "propertyNames": {
              "type": "string"
            }
          },
          "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "创建时间"
          }
        }
      },
      "PartitionDetail": {
        "type": "object",
        "required": [
          "date",
          "size_bytes"
        ],
        "properties": {
          "date": {
            "type": "string"
          },
          "size_bytes": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          }
        }
      },
      "RegenerateTokenResponse": {
        "type": "object",
        "description": "重新生成 Token 响应",
        "required": [
          "agent_id",
          "token"
        ],
        "properties": {
          "agent_id": {
            "type": "string",
            "description": "Agent 唯一标识"
          },
          "token": {
            "type": "string",
            "description": "新生成的认证 token"
          }
        }
      },
      "RuntimeConfig": {
        "type": "object",
        "description": "脱敏的运行时配置",
        "required": [
          "grpc_port",
          "http_port",
          "data_dir",
          "retention_days",
          "require_agent_auth",
          "cert_check_enabled",
          "cert_check_default_interval_secs",
          "cert_check_tick_secs",
          "cert_check_max_concurrent",
          "notification_aggregation_window_secs",
          "alert_rules_count",
          "notification_channels_count"
        ],
        "properties": {
          "grpc_port": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "http_port": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "data_dir": {
            "type": "string"
          },
          "retention_days": {
            "type": "integer",
            "format": "int32",
            "minimum": 0
          },
          "require_agent_auth": {
            "type": "boolean"
          },
          "cert_check_enabled": {
            "type": "boolean"
          },
          "cert_check_default_interval_secs": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          },
          "cert_check_tick_secs": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          },
          "cert_check_max_concurrent": {
            "type": "integer",
            "minimum": 0
          },
          "notification_aggregation_window_secs": {
            "type": "integer",
            "format": "int64",
            "minimum": 0
          },
          "alert_rules_count": {
            "type": "integer",
            "minimum": 0
          },
          "notification_channels_count": {
            "type": "integer",
            "minimum": 0
          }
        }
      },
      "SetRecipientsRequest": {
        "type": "object",
        "required": [
          "recipients"
        ],
        "properties": {
          "recipients": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "StorageInfo": {
        "type": "object",
        "description": "存储分区信息",
        "required": [
          "partitions",
          "total_partitions",
          "total_size_bytes"
        ],
        "properties": {
          "partitions": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/PartitionDetail"
            },
            "description": "分区列表"
          },
          "total_partitions": {
            "type": "integer",
            "description": "分区总数",
            "minimum": 0
          },
          "total_size_bytes": {
            "type": "integer",
            "format": "int64",
            "description": "总存储大小（字节）",
            "minimum": 0
          }
        }
      },
      "UpdateAgentRequest": {
        "type": "object",
        "description": "更新 Agent 白名单请求",
        "properties": {
          "description": {
            "type": [
              "string",
              "null"
            ],
            "description": "描述信息（可选）"
          }
        }
      },
      "UpdateDomainRequest": {
        "type": "object",
        "description": "更新域名请求",
        "properties": {
          "port": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int32",
            "description": "监控端口（可选）"
          },
          "enabled": {
            "type": [
              "boolean",
              "null"
            ],
            "description": "是否启用监控（可选）"
          },
          "check_interval_secs": {
            "type": [
              "integer",
              "null"
            ],
            "format": "int64",
            "description": "检查间隔秒数（可选；传 null 清除自定义值）",
            "minimum": 0
          },
          "note": {
            "type": [
              "string",
              "null"
            ],
            "description": "备注（可选）"
          }
        }
      }
    },
    "securitySchemes": {
      "bearer_auth": {
        "type": "http",
        "scheme": "bearer"
      }
    }
  },
  "tags": [
    {
      "name": "Health",
      "description": "服务健康检查"
    },
    {
      "name": "Auth",
      "description": "认证鉴权"
    },
    {
      "name": "Agents",
      "description": "Agent 管理"
    },
    {
      "name": "Metrics",
      "description": "指标查询"
    },
    {
      "name": "Alerts",
      "description": "告警规则与历史"
    },
    {
      "name": "Certificates",
      "description": "证书监控"
    },
    {
      "name": "Notifications",
      "description": "通知渠道管理"
    },
    {
      "name": "Dashboard",
      "description": "仪表盘概览"
    },
    {
      "name": "System",
      "description": "系统管理"
    }
  ]
}