# 缺陷分级与提单规范

适用范围：API 联调、页面回归、线上问题反馈  
建议配套：`docs/page-api-smoke-checklist.md`、`docs/page-api-smoke-result-template.md`

## 一、严重级别定义

### P0（阻塞发布 / 严重故障）

- 定义：
  - 核心流程不可用（登录、核心读写、关键页面白屏/崩溃）
  - 数据错误且影响范围广，或存在明显安全风险
- 处理时效建议：
  - 立即响应，优先修复

### P1（高优先级）

- 定义：
  - 核心流程可走通但结果错误
  - 重要功能不可用，但有临时绕过方案
- 处理时效建议：
  - 当日进入修复排期

### P2（中优先级）

- 定义：
  - 非核心流程异常
  - 展示/交互问题，对业务有影响但不阻塞主流程
- 处理时效建议：
  - 近期迭代修复

### P3（低优先级）

- 定义：
  - 文案、样式、轻微体验问题
  - 不影响功能正确性
- 处理时效建议：
  - 统一归档，择机处理

## 二、提单最小信息（必须）

- 问题标题（简洁明确）
- 严重级别（P0-P3）
- 影响页面（路由）
- 影响接口（`METHOD /v1/...`）
- 复现步骤（1、2、3）
- 实际结果
- 预期结果
- 请求/响应样例（脱敏）
- 版本信息（前端分支、后端版本、环境）

## 三、推荐附加信息（建议）

- 浏览器与版本
- 设备与分辨率
- 错误堆栈（前端控制台）
- 服务端日志关键片段（trace_id / err_code）
- 屏幕录制或截图

## 四、标题命名规范

推荐格式：

`[级别][模块] 简述问题 + 触发条件`

示例：

- `[P1][Notifications] 渠道编辑保存后未刷新列表（PUT /v1/notifications/channels/{id}）`
- `[P0][Auth] 登录后跳转循环，无法进入首页`
- `[P2][Dictionaries] 启用开关切换后状态文案未更新`

## 五、复现步骤模板

1. 进入页面：`/...`
2. 输入参数：`...`
3. 点击操作：`...`
4. 观察结果：`...`

## 六、接口问题判定建议

优先判断是哪一层问题：

- 前端请求构造错误（字段名、参数位置、路径编码）
- 后端接口实现与 OpenAPI 不一致
- 前端对响应解析错误（把 `IdResponse` 当详情对象使用）
- 业务数据本身异常（脏数据或迁移问题）

## 七、快速分流规则

- 满足任一项优先 P0：
  - 页面白屏/崩溃且可稳定复现
  - 登录或鉴权核心流程失败
  - 核心写操作导致明显数据破坏
- 满足任一项优先 P1：
  - 核心列表为空/错乱但接口返回正常
  - 写操作提示成功但数据未生效

## 八、提单模板（可复制）

```md
### 标题
[P1][模块] 一句话描述问题

### 基本信息
- 环境：
- 前端分支：
- 后端版本：
- 页面路由：
- 接口：

### 复现步骤
1.
2.
3.

### 实际结果

### 预期结果

### 请求样例（脱敏）

### 响应样例（脱敏）

### 附件
- 截图/录屏：
- 日志/trace_id：

### 备注
```

